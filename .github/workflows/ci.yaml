name: CI

on:
  pull_request:
    branches: [main]
  push:
    branches: [main]

jobs:
  lint:
    name: Lint
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Validate YAML syntax
        run: |
          echo "Checking for YAML syntax errors..."
          find . -name '*.yaml' -o -name '*.yml' | while read file; do
            python3 -c "import yaml; yaml.safe_load(open('$file'))" 2>/dev/null || echo "Warning: $file may have issues"
          done
          echo "YAML validation complete"

      - name: Validate Makefile exists
        run: |
          test -f Makefile && echo "Makefile exists" || exit 1

      - name: Show make targets
        run: make help

  # Placeholder for future cluster tests (Phase 1.2+)
  # cluster-test:
  #   name: Cluster Tests
  #   runs-on: ubuntu-latest
  #   needs: lint
  #   steps:
  #     - name: Checkout
  #       uses: actions/checkout@v4
  #     - name: Create KIND cluster
  #       run: make cluster-up
  #     - name: Run tests
  #       run: make test
  #     - name: Cleanup
  #       if: always()
  #       run: make cluster-down
